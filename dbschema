CREATE DATABASE PROJECT;

CREATE TABLE USERINFO (
    UserID INTEGER PRIMARY KEY,
    Username VARCHAR(20) NOT NULL,
    Password VARCHAR(20) NOT NULL,
    USERTYPE VARCHAR(10) NOT NULL
);

CREATE TABLE ADMIN (
    AdminID Integer PRIMARY KEY,
    Username VARCHAR(20) NOT NULL,
    Password VARCHAR(20) NOT NULL,
    UserID INTEGER NOT NULL,
    FOREIGN KEY(UserID) REFERENCES USERINFO(UserID)
);

CREATE TABLE NURSE (
    EmployeeID Integer PRIMARY KEY,
    Username VARCHAR(20) NOT NULL,
    Password VARCHAR(20) NOT NULL,
    UserID INTEGER NOT NULL,
    FName TEXT NOT NULL,
    MI CHAR,
    LName TEXT NOT NULL,
    Age INTEGER,
    Gender CHAR,
    PhoneNo BIGINT,
    Address TEXT,
    FOREIGN KEY(UserID) REFERENCES USERINFO(UserID)
);

CREATE TABLE PATIENT (
    SSN Integer PRIMARY KEY,
    Username VARCHAR(20) NOT NULL,
    Password VARCHAR(20) NOT NULL,
    UserID INTEGER NOT NULL,
    FName TEXT NOT NULL,
    MI CHAR,
    LName TEXT NOT NULL,
    Age INTEGER,
    Gender CHAR,
    Race TEXT NOT NULL,
    Occupation TEXT NOT NULL,
    Med_History TEXT,
    PhoneNo BIGINT,
    Address TEXT,
    FOREIGN KEY(UserID) REFERENCES USERINFO(UserID)
);

CREATE TABLE VACCINE (
    VaccineID Integer PRIMARY KEY,
    Name VARCHAR(25) NOT NULL,
    CompanyName VARCHAR(25) NOT NULL,
    RequiredDoses INTEGER NOT NULL,
    Description TEXT,
    Availability INTEGER NOT NULL,
    OnHold INTEGER NOT NULL
);

CREATE TABLE TIMESLOT (
    SlotID INTEGER PRIMARY KEY,
    Date DATE NOT NULL,
    TimeStart TIME NOT NULL,
    TimeEnd TIME NOT NULL,
    MaxCapacity Integer NOT NULL DEFAULT 0,
    NoScheduledNurses Integer NOT NULL DEFAULT 0,
    NoPatientScheduled Integer NOT NULL DEFAULT 0
);

CREATE TABLE NURSESCHEDULE (
    NSCHEDULEID INTEGER PRIMARY KEY,
    NurseID Integer NOT NULL,
    SlotID Integer NOT NULL,
    FOREIGN KEY(SlotID) REFERENCES TIMESLOT(SlotID),
    FOREIGN KEY(NurseID) REFERENCES NURSE(EmployeeID)
);

CREATE TABLE PATIENTSCHEDULE (
    PScheduleID INTEGER PRIMARY KEY,
    SlotID Integer NOT NULL,
    VaccineID INTEGER NOT NULL,
    PatientSSN INTEGER NOT NULL,
    FOREIGN KEY(SlotID) REFERENCES TIMESLOT(SlotID),
    FOREIGN KEY(VaccineID) REFERENCES VACCINE(VaccineID),
    FOREIGN KEY(PatientSSN) REFERENCES PATIENT(SSN)
);

CREATE TABLE VACCINATIONRECORD (
    RecordID INTEGER PRIMARY KEY,
    PatientSSN INTEGER NOT NULL,
    NurseID Integer NOT NULL,
    SlotID Integer NOT NULL,
    VaccineID INTEGER NOT NULL,
    DoseNumber INTEGER NOT NULL,
    VaccinationTime TIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    Date DATE NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY(SlotID) REFERENCES TIMESLOT(SlotID),
    FOREIGN KEY(VaccineID) REFERENCES VACCINE(VaccineID),
    FOREIGN KEY(PatientSSN) REFERENCES PATIENT(SSN),
    FOREIGN KEY(NurseID) REFERENCES NURSE(EmployeeID)
);